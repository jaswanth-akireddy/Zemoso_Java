q1 - 

SELECT title
FROM film
WHERE rating = 'PG-13'
  AND film_id IN (
    SELECT film_id
    FROM film_category
    WHERE category_id = (
        SELECT category_id
        FROM category
        WHERE name = 'Comedy'
    )
);


q2 -

SELECT f.title, COUNT(*) AS rental_count
FROM film f
JOIN inventory i ON f.film_id = i.film_id
JOIN rental r ON i.inventory_id = r.inventory_id
JOIN film_category fc ON f.film_id = fc.film_id
JOIN category c ON fc.category_id = c.category_id
WHERE c.name = 'Horror'
GROUP BY f.film_id
ORDER BY rental_count DESC
LIMIT 3;


q3 -


SELECT c.first_name, c.last_name
FROM customer c
JOIN rental r ON c.customer_id = r.customer_id
JOIN inventory i ON r.inventory_id = i.inventory_id
JOIN film f ON i.film_id = f.film_id
JOIN film_category fc ON f.film_id = fc.film_id
JOIN category cat ON fc.category_id = cat.category_id
WHERE cat.name = 'Sports'


q4 -


SELECT c.first_name, c.last_name, c.email 
FROM customer c
JOIN rental r ON c.customer_id = r.customer_id
JOIN inventory i ON r.inventory_id = i.inventory_id
JOIN film f ON i.film_id = f.film_id
JOIN film_actor fc on fc.film_id=i.film_id
JOIN actor a ON fc.actor_id = a.actor_id
JOIN ADDRESS ad ON ad.address_id = c.customer_id
JOIN city ci on ci.city_id = ad.city_id
JOIN country co on co.country_id = ci.country_id
WHERE co.country = 'Canada'
AND a.first_name = 'NICK'
AND a.last_name = 'WAHLBERG';



q5 -


SELECT COUNT(*) 
FROM film f
JOIN film_actor fa ON f.film_id = fa.film_id
JOIN actor a ON fa.actor_id = a.actor_id
WHERE a.first_name = 'SEAN' AND a.last_name = 'WILLIAMS';


q6 -

SELECT COUNT(*) 
FROM film f
JOIN film_category fc ON f.film_id = fc.film_id
JOIN category c ON fc.category_id = c.category_id
WHERE c.name = 'Documentary' AND f.special_features LIKE '%Deleted Scenes%';

q7 -

SELECT COUNT(*) 
FROM film f
JOIN inventory i ON f.film_id = i.film_id
JOIN rental r ON i.inventory_id = r.inventory_id
JOIN staff s ON r.staff_id = s.staff_id
JOIN film_category fc ON f.film_id = fc.film_id
JOIN category c ON fc.category_id = c.category_id
WHERE s.first_name = 'Jon' AND s.last_name = 'Stephens' AND c.name = 'Sci-Fi';


q8 -


SELECT SUM(p.amount) 
FROM payment p
JOIN rental r ON p.rental_id = r.rental_id
JOIN inventory i ON r.inventory_id = i.inventory_id
JOIN film_category fc ON i.film_id = fc.film_id
JOIN category c ON fc.category_id = c.category_id
WHERE c.name = 'Animation';



q9 -


SELECT c.name, COUNT(*) AS rentals_count
FROM customer cu
JOIN rental r ON cu.customer_id = r.customer_id
JOIN inventory i ON r.inventory_id = i.inventory_id
JOIN film_category fc ON i.film_id = fc.film_id
JOIN category c ON fc.category_id = c.category_id
WHERE cu.first_name = 'PATRICIA' AND cu.last_name = 'JOHNSON'
GROUP BY c.name
ORDER BY rentals_count DESC
LIMIT 3;



q10 -


SELECT COUNT(*) 
FROM customer cu
JOIN rental r ON cu.customer_id = r.customer_id
JOIN inventory i ON r.inventory_id = i.inventory_id
JOIN film f ON i.film_id = f.film_id
WHERE cu.first_name = 'SUSAN' AND cu.last_name = 'WILSON' AND f.rating = 'R';





